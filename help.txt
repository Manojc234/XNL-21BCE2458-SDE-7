import { Routes, Route, Navigate, BrowserRouter } from "react-router-dom";
import { useEffect, useState, useRef } from "react";

import ChangeAccount from "./pages/ChangeAccount";
import ServiceRequest from "./pages/ServiceRequest";
import EditAccount from "./pages/EditAccount";
import EditEmployee from "./pages/EditEmployeeAccounts";
import AccountDetails from "./pages/AccountDetails";
import ViewEmployees from "./pages/ViewEmployees";
import Layout from "./pages/Layout";
import ProtectedRoute from "./Components/ProtectedRoute";
import ChangePassword from "./pages/ChangePassword";
import Login from "./pages/Login";
import Signup from "./pages/Signup";
import AccessibilityTools from "./Components/AccessibilityTools";

function App() {
  const [role, setRole] = useState(null);
  const [showSignUp, setShowSignUp] = useState(false);
  const mainRef = useRef();

  // Restore role on refresh
  useEffect(() => {
    const savedRole = localStorage.getItem("role");
    if (savedRole) setRole(savedRole);
  }, []);

  // Handle login
  const handleLogin = (roleValue) => {
    setRole(roleValue);
    localStorage.setItem("role", roleValue);
  };

  // Handle logout
  const handleLogout = () => {
    setRole(null);
    localStorage.removeItem("role");
  };

  // Accessibility readout
  function handleReadout() {
    if (window.speechSynthesis) {
      const text = mainRef.current
        ? mainRef.current.innerText
        : document.body.innerText;
      const utter = new window.SpeechSynthesisUtterance(text);
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(utter);
    }
  }

  return (
    <BrowserRouter>
      <AccessibilityTools onReadout={handleReadout} />

      <div ref={mainRef}>
        <Routes>
          {!role ? (
            <>
              {showSignUp ? (
                <Route
                  path="/signup"
                  element={<Signup />}
                />
              ) : (
                <Route
                  path="/login"
                  element={
                    <Login
                      onLogin={handleLogin}
                      onNavigateToSignup={() => setShowSignUp(true)}
                    />
                  }
                />
              )}
            </>
          ) : (
            <Route path="/" element={<Layout role={role} onLogout={handleLogout} />}>
              <Route
                path="/change-account"
                element={
                  <ProtectedRoute role={role} allowedRoles={["creator"]}>
                    <ChangeAccount />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/service-request"
                element={
                  <ProtectedRoute role={role} allowedRoles={["creator", "manager"]}>
                    <ServiceRequest />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/edit-account"
                element={
                  <ProtectedRoute role={role} allowedRoles={["creator"]}>
                    <EditAccount />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/edit-employee"
                element={
                  <ProtectedRoute role={role} allowedRoles={["creator"]}>
                    <EditEmployee />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/view-account"
                element={
                  <ProtectedRoute role={role} allowedRoles={["creator", "manager"]}>
                    <AccountDetails />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/view-employees"
                element={
                  <ProtectedRoute role={role} allowedRoles={["creator", "manager"]}>
                    <ViewEmployees />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/change-password"
                element={
                  <ProtectedRoute
                    role={role}
                    allowedRoles={["creator", "manager", "approver"]}
                  >
                    <ChangePassword />
                  </ProtectedRoute>
                }
              />
            </Route>
          )}
        </Routes>
      </div>
    </BrowserRouter>
  );
}
export default App;

import React, { useState } from "react";

function Signup({ onSignup, onNavigateToLogin }) {
  const [username, setUsername] = useState("");
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [confirmPassword, setConfirmPassword] = useState("");
  const [message, setMessage] = useState("");

  return (
    <div
      style={{
        minHeight: "100vh",
        position: "relative",
        backgroundImage: "linear-gradient(120deg, #0050a8 0%, #00b140 100%)",
        animation: "bgMove 12s ease-in-out infinite alternate",
        transition: "background 0.5s",
      }}
    >
      <style>{`
        @keyframes bgMove {
          0% { background-position: 0% 50%; }
          100% { background-position: 100% 50%; }
        }
      `}</style>

      {/* Top bars */}
      <div
        style={{
          height: "12px",
          background: "linear-gradient(90deg, #0050a8 0%, #0096ff 100%)",
          boxShadow: "0 2px 12px #0050a8cc",
        }}
      ></div>
      <div
        style={{
          height: "12px",
          background: "linear-gradient(90deg, #00d65b 0%, #00b140 100%)",
          boxShadow: "0 2px 12px #00d65bcc",
        }}
      ></div>

      <div className="container py-5">
        {/* Logo */}
        <div className="d-flex justify-content-start mt-4">
          <img
            src="https://upload.wikimedia.org/wikipedia/commons/0/0c/Standard_Chartered_%282021%29.svg"
            alt="SCB Logo"
            style={{
              height: "48px",
              background: "#fff",
              borderRadius: "12px",
              boxShadow: "0 0 16px 0 #0072ce44, 0 0 8px 0 #00b14044",
              padding: "6px 18px",
              marginBottom: 12,
            }}
          />
        </div>

        {/* Card */}
        <div
          className="row justify-content-center align-items-center"
          style={{ minHeight: "60vh" }}
        >
          <div className="col-md-6">
            <div
              className="card border-0 login-card-exciting"
              style={{
                borderRadius: 20,
                boxShadow: "0 8px 40px 0 #0072ce22, 0 2px 8px 0 #00b14022",
                transition: "box-shadow 0.3s",
              }}
            >
              <div className="card-body p-5">
                <h2 className="text-center mb-2" style={{ fontWeight: 600 }}>
                  Signup
                </h2>
                <div className="text-center text-muted mb-4">
                  Create a new account
                </div>

                <form
                  onSubmit={(e) => {
                    e.preventDefault();
                    if (!username || !email || !password || !confirmPassword) {
                      setMessage("Please fill all fields.");
                    } else if (password !== confirmPassword) {
                      setMessage("Passwords do not match.");
                    } else {
                      onSignup(username, email, password);
                    }
                  }}
                >
                  <div className="mb-3">
                    <label className="form-label">Username</label>
                    <input
                      type="text"
                      className="form-control"
                      placeholder="Enter username"
                      value={username}
                      onChange={(e) => setUsername(e.target.value)}
                    />
                  </div>
                  <div className="mb-3">
                    <label className="form-label">Email</label>
                    <input
                      type="email"
                      className="form-control"
                      placeholder="Enter email"
                      value={email}
                      onChange={(e) => setEmail(e.target.value)}
                    />
                  </div>
                  <div className="mb-3">
                    <label className="form-label">Password</label>
                    <input
                      type="password"
                      className="form-control"
                      placeholder="Enter password"
                      value={password}
                      onChange={(e) => setPassword(e.target.value)}
                    />
                  </div>
                  <div className="mb-4">
                    <label className="form-label">Confirm Password</label>
                    <input
                      type="password"
                      className="form-control"
                      placeholder="Confirm password"
                      value={confirmPassword}
                      onChange={(e) => setConfirmPassword(e.target.value)}
                    />
                  </div>
                  <button
                    type="submit"
                    className="btn btn-success w-100 mb-3"
                    style={{ borderRadius: "8px", fontWeight: 500 }}
                  >
                    Signup
                  </button>
                  <div className="text-center">
                    <button
                      type="button"
                      className="btn btn-link p-0"
                      onClick={onNavigateToLogin}
                    >
                      Already have an account? Login
                    </button>
                  </div>
                  {message && (
                    <div className="alert alert-info mt-3">{message}</div>
                  )}
                </form>
              </div>
            </div>

            <style>{`
              .login-card-exciting:hover {
                box-shadow: 0 16px 60px 0 #0072ce44, 0 4px 16px 0 #00b14044;
              }
            `}</style>

            <div
              className="text-center mt-4 text-muted"
              style={{ fontSize: "1rem" }}
            >
              Standard Chartered Bank © 2025 | Secure Banking Solutions
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

export default Signup;

import React, { useState } from "react";
import { useNavigate } from "react-router-dom";
import Signup from "./Signup";


function LoginPage({ onLogin,onNavigateToSignup  }) {
  const [username, setUsername] = useState("");
  const [password, setPassword] = useState("");
  const [message, setMessage] = useState("");
  const navigate = useNavigate();

  const handleLogin = (e) => {
    e.preventDefault();
    if (!username || !password) {
      setMessage("Please enter username and password.");
      return;
    }

    let role = "creator";
    if (username === "approver@gmail.com") role = "manager";

    if (password === "1234") {
      onLogin(role);
      navigate("/"); // go to dashboard
    } else {
      setMessage("Invalid credentials");
    }
  };

  return (
    <div
      style={{
        minHeight: "100vh",
        position: "relative",
        backgroundImage: "linear-gradient(120deg, #0050a8 0%, #00b140 100%)",
        animation: "bgMove 12s ease-in-out infinite alternate",
        transition: "background 0.5s",
      }}
    >
      <style>{`
        @keyframes bgMove {
          0% { background-position: 0% 50%; }
          100% { background-position: 100% 50%; }
        }
      `}</style>

      {/* Top bars */}
      <div
        style={{
          height: "12px",
          background: "linear-gradient(90deg, #0050a8 0%, #0096ff 100%)",
          boxShadow: "0 2px 12px #0050a8cc",
        }}
      ></div>
      <div
        style={{
          height: "12px",
          background: "linear-gradient(90deg, #00d65b 0%, #00b140 100%)",
          boxShadow: "0 2px 12px #00d65bcc",
        }}
      ></div>

      <div className="container py-5">
        {/* Logo */}
        <div className="d-flex justify-content-start mt-4">
          <img
            src="https://upload.wikimedia.org/wikipedia/commons/0/0c/Standard_Chartered_%282021%29.svg"
            alt="SCB Logo"
            style={{
              height: "48px",
              background: "#fff",
              borderRadius: "12px",
              boxShadow: "0 0 16px 0 #0072ce44, 0 0 8px 0 #00b14044",
              padding: "6px 18px",
              marginBottom: 12,
            }}
          />
        </div>

        {/* Card */}
        <div
          className="row justify-content-center align-items-center"
          style={{ minHeight: "60vh" }}
        >
          <div className="col-md-6">
            <div
              className="card border-0 login-card-exciting"
              style={{
                borderRadius: 20,
                boxShadow: "0 8px 40px 0 #0072ce22, 0 2px 8px 0 #00b14022",
                transition: "box-shadow 0.3s",
              }}
            >
              <div className="card-body p-5">
                <h2 className="text-center mb-2" style={{ fontWeight: 600 }}>
                  Login
                </h2>
                <div className="text-center text-muted mb-4">
                  Welcome back, please sign in
                </div>

                <form onSubmit={handleLogin}>
                  <div className="mb-3">
                    <label className="form-label">Username</label>
                    <input
                      type="text"
                      className="form-control"
                      placeholder="Enter username"
                      value={username}
                      onChange={(e) => setUsername(e.target.value)}
                    />
                  </div>
                  <div className="mb-4">
                    <label className="form-label">Password</label>
                    <input
                      type="password"
                      className="form-control"
                      placeholder="Enter password"
                      value={password}
                      onChange={(e) => setPassword(e.target.value)}
                    />
                  </div>
                  <button
                    type="submit"
                    className="btn btn-primary w-100 mb-3"
                    style={{ borderRadius: "8px", fontWeight: 500 }}
                  >
                    Login
                  </button>
                  <div className="text-center">
                    <button
                      type="button"
                      className="btn btn-link p-0"
                      onClick={handleClick=>{
                        navigate("/signup");
                      }}
                    >
                      Create an account
                    </button>
                  </div>
                  {message && (
                    <div className="alert alert-info mt-3">{message}</div>
                  )}
                </form>
              </div>
            </div>

            <style>{`
              .login-card-exciting:hover {
                box-shadow: 0 16px 60px 0 #0072ce44, 0 4px 16px 0 #00b14044;
              }
            `}</style>

            <div
              className="text-center mt-4 text-muted"
              style={{ fontSize: "1rem" }}
            >
              Standard Chartered Bank © 2025 | Secure Banking Solutions
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

export default LoginPage;
